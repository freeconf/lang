syntax="proto3";

option go_package = "./pb";

package pb;

message XVoid {}

message ChildRequest {
      uint64 selHnd = 1;
      string metaIdent = 3;
      bool new = 4;
      bool delete = 5;      
}

message Val {
      oneof value {
            string str = 1;
            int32 i32 = 2;
            int64 i64 = 3;
      }
}

message FieldRequest {
      uint64 selHnd = 1;
      string metaIdent = 2;
      bool write = 3;
      bool clear = 4;
      Val toWrite = 5;
}

message FieldResponse {
      Val fromRead = 1;
}

message ChildResponse {
      uint64 nodeHnd = 1;
}

message NodeSourceRequest {
      uint64 browserHnd = 1;
}

message NodeSourceResponse {
      uint64 nodeHnd = 1;
}

message RootSelectionRequest {
      uint64 browserHnd = 1;
      uint64 selHnd = 2;
}

message RootSelectionResponse {
      uint64 selHnd = 1;
}

message SelectRequest {
      uint64 parentSelHnd = 1;
      uint64 nodeHnd = 3;
      uint64 browserHnd = 4;
      string metaIdent = 5;
}

message SelectResponse {
      uint64 selHnd = 1;      
}

message XActionRequest {
      uint64 selHnd = 1;
      uint64 inputSelHnd = 2;
      string metaIdent = 3;
}

message XActionResponse {
      uint64 outputNodeHnd = 1;
}

message XNotificationRequest {
      uint64 selHnd = 1;
      string metaIdent = 3;
}

message XNotificationResponse {
      // time
      uint64 nodeHnd = 1;
}

service XNode {
      rpc RootSelection(RootSelectionRequest) returns (RootSelectionResponse) {}
      rpc NodeSource(NodeSourceRequest) returns (NodeSourceResponse) {}
      rpc Select(SelectRequest) returns (SelectResponse) {}
      rpc Child(ChildRequest) returns (ChildResponse) {}
      rpc Field(FieldRequest) returns (FieldResponse) {}
      rpc Action(XActionRequest) returns (XActionResponse) {}
      rpc Notification(XNotificationRequest) returns (stream XNotificationResponse) {}
}

message XReleaseRequest {
      uint64 xHnd = 1;
}

service XHandles {
      rpc Release (XReleaseRequest) returns (XVoid) {}
}
